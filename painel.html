<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Painel - I.E.P.C</title>
<style>
  body {
    font-family: 'Georgia', serif;
    background: #fdfcf7;
    margin: 0;
    padding: 0;
    color: #4b1e0f;
    text-shadow: 1px 1px 2px rgba(255, 215, 0, 0.5);
    line-height: 1.6;
  }
  header {
    background: linear-gradient(45deg, gold, darkred);
    color: white;
    padding: 15px;
    text-align: center;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
    font-weight: 900;
    letter-spacing: 2px;
  }
  main {
    padding: 20px;
    max-width: 900px;
    margin: auto;
  }
  section {
    background: white;
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    color: #4b1e0f;
    text-shadow: 1px 1px 2px rgba(255, 215, 0, 0.3);
    font-weight: 600;
  }
  h2 {
    margin-top: 0;
    color: darkred;
    text-shadow: 1px 1px 3px rgba(139,0,0,0.7);
    font-weight: 900;
    letter-spacing: 1.5px;
  }
  button {
    background: darkred;
    color: gold;
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-family: 'Arial Black', Arial, sans-serif;
    font-weight: 900;
    letter-spacing: 2px;
    box-shadow: 0 0 10px gold;
    transition: all 0.3s ease;
    text-shadow: 1px 1px 2px black;
  }
  button:hover {
    background: #a30000;
    box-shadow: 0 0 20px orange;
    color: #fff3cd;
    text-shadow: 2px 2px 4px black;
  }
  #mensagem {
    width: 100%;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid darkred;
    font-family: 'Georgia', serif;
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 10px;
    box-shadow: inset 0 0 5px rgba(255, 215, 0, 0.3);
    color: #4b1e0f;
    text-shadow: 1px 1px 1px rgba(255, 215, 0, 0.2);
  }
  #mensagem:focus {
    outline: none;
    border-color: gold;
    box-shadow: 0 0 10px gold;
  }
  #chat-mensagens {
    height: 150px;
    overflow-y: auto;
    border: 1px solid darkred;
    padding: 8px;
    background: #fff8e1;
    border-radius: 6px;
    margin-bottom: 10px;
  }
</style>
</head>
<body>
<header>
  <h1>Painel da Igreja I.E.P.C</h1>
  <p id="status">Carregando usuário...</p>
</header>

<main id="conteudo" style="display:none;">
  <section id="info-igreja">
    <h2>Endereço</h2>
    <p>Igreja Evangélica Pentecostal Cristã (I.E.P.C)<br>Rua Curitiba, 2209 – final da Rua Curitiba</p>
  </section>

  <section id="info-pastor">
    <h2>Pastor</h2>
    <p>Pastor Airton</p>
  </section>

  <section id="info-cultos">
    <h2>Cultos</h2>
    <p>Todos os domingos às 15h</p>
    <p>Santa Ceia: segundo domingo do mês às 10h</p>
    <p>Encontro de casais: hoje</p>
  </section>

  <section id="info-santa-ceia">
    <h2>Santa Ceia e Batismo</h2>
    <p>A Santa Ceia ocorre no segundo domingo do mês às 10h.</p>
    <p>O batismo acontece logo após a Santa Ceia, em um local adequado, para os irmãos que desejam dar esse passo na fé.</p>
  </section>

  <section id="ministerios">
    <h2>Ministérios e Responsáveis</h2>
    <p><strong>Jovens:</strong> Responsáveis: Lucas e Cleiceane</p>
    <p>Os ministérios de ação social, evangelismo, casais e intercessão ainda acontecem concentrados em um único dia e serão organizados futuramente em dias separados.</p>
  </section>

  <section id="agenda-eventos">
    <h2>Agenda de Eventos</h2>
    <p><strong>Culto Normal:</strong> Todos os domingos às 15h</p>
    <p><strong>Santa Ceia:</strong> Segundo domingo do mês às 10h da manhã</p>
    <p><strong>Batismo:</strong> Logo após a Santa Ceia</p>
    <p><strong>Eventos especiais aos sábados:</strong></p>
    <ul>
      <li>09/08 – Encontro de Casais</li>
      <li>16/08 – Célula</li>
      <li>23/08 – Encontro de Jovens</li>
      <li>30/08 – Acampadentro das Meninas</li>
    </ul>
  </section>

  <section id="chat">
    <h2>Chat</h2>
    <div id="chat-mensagens">Carregando...</div>
    <input type="text" id="mensagem" placeholder="Digite sua mensagem..." />
    <button id="btnEnviar">Enviar</button>
  </section>

  <button id="btnLogout">Sair</button>
</main>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";
  import { getFirestore, collection, getDocs, addDoc, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB72qfOYuZBzMzQ8IX-Pk1744IPVtCrMSs",
    authDomain: "login-igreja.firebaseapp.com",
    projectId: "login-igreja",
    storageBucket: "login-igreja.firebasestorage.app",
    messagingSenderId: "65515596204",
    appId: "1:65515596204:web:19c691c79b7b9bc70c7209",
    measurementId: "G-P3L7MN23S0"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const statusEl = document.getElementById("status");
  const conteudoEl = document.getElementById("conteudo");
  const chatMensagensEl = document.getElementById("chat-mensagens");
  const mensagemInput = document.getElementById("mensagem");
  const btnEnviar = document.getElementById("btnEnviar");

  function renderMensagens(docs) {
    if (docs.length === 0) {
      chatMensagensEl.innerHTML = "<p>Nenhuma mensagem ainda.</p>";
      return;
    }
    chatMensagensEl.innerHTML = "";
    docs.forEach(doc => {
      const data = doc.data();
      const p = document.createElement("p");
      p.innerHTML = `<b>${data.usuario}:</b> ${data.mensagem}`;
      chatMensagensEl.appendChild(p);
    });
    chatMensagensEl.scrollTop = chatMensagensEl.scrollHeight;
  }

  async function carregarMensagens() {
    const q = query(collection(db, "chat"), orderBy("timestamp", "asc"));
    const snap = await getDocs(q);
    renderMensagens(snap.docs);
  }

  async function enviarMensagem() {
    const texto = mensagemInput.value.trim();
    if (texto === "") return;
    const user = auth.currentUser;
    await addDoc(collection(db, "chat"), {
      usuario: user.email,
      mensagem: texto,
      timestamp: serverTimestamp()
    });
    mensagemInput.value = "";
    carregarMensagens();
  }

  btnEnviar.addEventListener("click", enviarMensagem);

  mensagemInput.addEventListener("keyup", e => {
    if (e.key === "Enter") {
      enviarMensagem();
    }
  });

  document.getElementById("btnLogout").addEventListener("click", () => {
    signOut(auth).then(() => {
      window.location.href = "login.html";
    });
  });

  onAuthStateChanged(auth, (user) => {
    if (user) {
      statusEl.textContent = `Bem-vindo, ${user.email}`;
      conteudoEl.style.display = "block";
      carregarMensagens();
    } else {
      statusEl.textContent = "Usuário não autenticado. Redirecionando para login...";
      setTimeout(() => {
        window.location.href = "login.html";
      }, 1500);
    }
  });
</script>

</body>
      </html>
